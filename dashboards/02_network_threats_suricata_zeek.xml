<dashboard>
  <label>Network Threats — Suricata & Zeek</label>
  <description>Suricata signatures and Zeek protocol analytics for scans, brute force, and unusual traffic.</description>
  <row>
    <panel>
      <title>Suricata Alerts over Time (5m)</title>
      <chart>
        <search>
          <query>
            <![CDATA[
index=securityonion sourcetype=suricata:fast
| bin _time span=5m
| stats count by _time
            ]]>
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">line</option>
      </chart>
    </panel>
    <panel>
      <title>Top Signatures (last 24h)</title>
      <chart>
        <search>
          <query>
            <![CDATA[
index=securityonion sourcetype=suricata:fast
| stats count by signature
| sort - count | head 15
            ]]>
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top Talkers (src → dest)</title>
      <table>
        <search>
          <query>
            <![CDATA[
index=securityonion (sourcetype=suricata:fast OR sourcetype=zeek:conn)
| stats count by src_ip, dest_ip
| sort - count | head 20
            ]]>
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
      </table>
    </panel>
    <panel>
      <title>Scan Detector (Suricata scan-y sigs or Zeek bursts)</title>
      <table>
        <search>
          <query>
            <![CDATA[
(index=securityonion sourcetype=suricata:fast signature="*SCAN*" OR signature="*Portscan*")
OR (index=securityonion sourcetype=zeek:conn)
| eval is_scan=if(signature!="" OR (sourcetype="zeek:conn" AND bytes_out>0 AND bytes_in=0), 1, 0)
| where is_scan=1
| stats count by src_ip, dest_ip, signature
| sort - count | head 20
            ]]>
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
      </table>
    </panel>
  </row>
</dashboard>
