<dashboard>
  <label>Vulnerability Remediation â€” Nessus</label>
  <description>Track open vulnerabilities, CVEs, affected hosts, and verify remediations after patch.</description>
  <row>
    <panel>
      <title>Open Vulns by Severity</title>
      <chart>
        <search>
          <query>
            <![CDATA[
index=nessus sourcetype=nessus:sc:vuln
| eval sev=coalesce(severity, severity_code)
| stats count by sev
| sort sev
            ]]>
          </query>
          <earliest>-7d@d</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">column</option>
      </chart>
    </panel>
    <panel>
      <title>Top CVEs (last 7d)</title>
      <chart>
        <search>
          <query>
            <![CDATA[
index=nessus sourcetype=nessus:sc:vuln
| stats count by cve
| sort - count | head 15
            ]]>
          </query>
          <earliest>-7d@d</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Hosts with Most Open Vulns</title>
      <table>
        <search>
          <query>
            <![CDATA[
index=nessus sourcetype=nessus:sc:vuln
| stats count by host
| sort - count | head 20
            ]]>
          </query>
          <earliest>-7d@d</earliest>
          <latest>now</latest>
        </search>
      </table>
    </panel>
    <panel>
      <title>Rescan Verification (closed findings trend)</title>
      <chart>
        <search>
          <query>
            <![CDATA[
index=nessus sourcetype=nessus:sc:vuln status=closed OR plugin_output="*no longer*"
| bin _time span=1d
| stats count as closed_findings by _time
            ]]>
          </query>
          <earliest>-14d@d</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">line</option>
      </chart>
    </panel>
  </row>
</dashboard>
